apiVersion: kustomize.config.k8s.io/v1beta1
kind: Kustomization

bases:
  - "../../base"

patches:
  - target:
      group: argoproj.io
      version: v1alpha1
      kind: Application
      name: node-red
    patch: |-
      - op: "replace"
        path: "/metadata/namespace"
        value: "openshift-gitops"

      - op: "add"
        path: "/spec/source/helm/parameters"
        value: []

      - op: "add"
        path: "/spec/source/helm/parameters/-"
        value:
          name: ingress.main.enabled
          value: "false"

      - op: "add"
        path: "/spec/source/helm/parameters/-"
        value:
          name: persistence.data.storageClass
          value: "odf-lvm-vg1"

      - op: "add"
        path: "/spec/source/helm/parameters/-"
        value:
          name: dnsConfig.nameservers[0]
          value: 192.168.1.207
      - op: "add"
        path: "/spec/source/helm/parameters/-"
        value:
          name: dnsConfig.searches[0]
          value: janz.lan
